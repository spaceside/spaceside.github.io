<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.68/Build/Cesium/Cesium.js"></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.68/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
</head>
<body>
  <div id="cesiumContainer" style="width: 100%; height:70%"></div>
  <script>

// Grant CesiumJS access to your ion assets
Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJmODI2YzAwOS0xOTg4LTQ3ZDYtOTRmZS1jNTU0MzVjZGQyYTgiLCJpZCI6MTM5OTEsInNjb3BlcyI6WyJhc3IiLCJnYyJdLCJpYXQiOjE1NjQ1MzMyNzl9.6_a3Wu9fGbwz5AoTlAp4lPmy_v6-bkr4PaI_Y2gqcC4';

var transparentBaseLayer = new Cesium.SingleTileImageryProvider({ url : "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNgYAAAAAMAASsJTYQAAAAASUVORK5CYII=" });
cesiumWidget = new Cesium.Viewer('cesiumContainer', {
       imageryProvider : transparentBaseLayer, 
       baseLayerPicker : false,
       timeline: false,
       skyBox : false,
       skyAtmosphere : false,
       contextOptions : { webgl: {
              preserveDrawingBuffer:true,
              alpha: true }}
       });
cesiumWidget.scene.backgroundColor = Cesium.Color.TRANSPARENT;
cesiumWidget.scene.globe.baseColor = Cesium.Color.TRANSPARENT;

SurfaceView surView = (SurfaceView)findViewById(R.id.sview);
SurfaceHolder camHolder = surView.getHolder();
// To do: Implement SurfaceHolder.Callback
camHolder.addCallback(this);

WebView webview = (WebView)findViewById(R.id.webview);
webview.setBackgroundColor(Color.TRANSPARENT);
webview.getSettings().setJavaScriptEnabled(true);
webview.getSettings().setAllowFileAccessFromFileURLs(true);
webview.loadUrl("file:///android_asset/ar.html");

String cesiumCamJS = "cesiumWidget.camera.setView({" +
"    destination: Cesium.Cartesian3.fromDegrees(" +
"       " + myLongitude + "," +
"       " + myLatitude + "," +
"       " + myAltitude +
"       )," +
"    orientation: {" +
"        heading: " + myAzimuth + "," +
"        pitch: " + Math.toRadians(myPitch) + "," +
"        roll: " + myRoll +
"    }" +
"});";
Webview.loadUrl("javascript:" + cesiumCamJS);


function drillPickEntities(viewer, windowPosition) {
  var i;
  var entity;
  var picked;
  var pickedPrimitives = viewer.scene.drillPick(windowPosition);
  var length = pickedPrimitives.length;
  var result = [];
  var hash = {};

  for (i = 0; i < length; i++) {
    picked = pickedPrimitives[i];
    entity = Cesium.defaultValue(picked.id, picked.primitive.id);
    if (entity instanceof Cesium.Entity &&
        !Cesium.defined(hash[entity.id])) {
      result.push(entity);
      hash[entity.id] = true;
    }
  }
  return result;
};


var imageryLayers = viewer.imageryLayers;
imageryLayers.addImageryProvider(new Cesium.ArcGisMapServerImageryProvider({
    url : 'https://maps.gdc.govt.nz/arcgis/rest/services/Open_Data/GDC_utilties_stormwater/MapServer',
    layers: '0',
}));


imageryLayers.addImageryProvider(new Cesium.ArcGisMapServerImageryProvider({
    url : 'https://maps.gdc.govt.nz/arcgis/rest/services/Open_Data/GDC_utilties_wastewater/MapServer',
    layers: '0',
}));

imageryLayers.addImageryProvider(new Cesium.ArcGisMapServerImageryProvider({
    url : 'https://maps.gdc.govt.nz/arcgis/rest/services/Open_Data/GDC_utilties_water/MapServer',
    layers: '0',
}));


    viewer.dataSources.add(Cesium.GeoJsonDataSource.load('https://spaceside.github.io/090/GeoJSON/CityCycleandWalkways.GeoJSON'));



    viewer.dataSources.add(Cesium.GeoJsonDataSource.load('https://spaceside.github.io/090/GeoJSON/ProposedWalkways.GeoJSON'));


var Bridges = Cesium.GeoJsonDataSource.load('https://spaceside.github.io/090/GeoJSON/IntersectingBridgesBuffer50m.GeoJSON',{
        stroke: Cesium.Color.HOTPINK,
        fill: Cesium.Color.HOTPINK.withAlpha(0.5),
        strokeWidth: 10
    });

      viewer.dataSources.add(Bridges);
      viewer.zoomTo(Bridges);
        
 </script>
</body>
</html>

  
